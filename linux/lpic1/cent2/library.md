# 共有ライブラリについて

プログラムの実行時に呼び出されるライブラリのこと。
プログラムの作成時に呼び出されるのは、静的ライブラリ。

共有ライブラリの呼び出し方（ダイナミックリンク）によって、
様々な実行ファイルにライブラリの機能が重複して入ることを防ぐ。

## 共有ライブラリの特徴

- `lib 〜 .so 〜`という名前が付けられる・
- 通常`/lib`か`/usr/lib`に配置される。

## とある実行ファイルが必要としている共有ライブラリの確認方法

lddコマンドで確認可能
例えば、catコマンドが必要としている共有ライブラリは、下記のように確認可能

```
$ ldd /bin/cat
	linux-vdso.so.1 =>  (0x00007ffe05f4c000)
	libc.so.6 => /lib64/libc.so.6 (0x00007fc2e4d09000)
	/lib64/ld-linux-x86-64.so.2 (0x00007fc2e50d7000)
```

## 実行時の共有ライブラリ検索方法

- `/lib`・`/usr/lib`のライブラリを検索する
- 上記以外のライブラリを検索する場合、そのリストを`/etc/ld.so.conf`に記述しておくと読み込まれる

ただし、実際はバイナリのキャッシュである`/etc/ld.so.cache`が参照される。
反映方法は「検索対象の共有ライブラリ更新方法」を参照

その他、環境変数`LD_LIBRARY_PATH`に検索対象ディレクトリを記述しておくと、そこからも検索される。

### 検索順

環境変数`LD_LIBRARY_PATH` > `/etc/ld.so.cache` > `/lib`・`/usr/lib`

### 検索対象の共有ライブラリ更新方法

- まず、`/etc/ld.so.conf`に追記
- その後`ldconfig`コマンドを実行
- すると、`/etc/ld.so.conf`ファイルに基づいて``/etc/ld.so.cache`が更新される
